#!/bin/bash

REMOTE_PATH="{{ DSE_DATA_MODEL_DEPLOYER_REMOTE_PATH }}/dse-datamodel-deploy-{{ MODEL_TYPE }}/lib/AppSqlAzureRunner.js"
ENVIRONMENT="{{ ENVIRONMENT }}"
SCRIPT_VERSION="{{ SCRIPT_VERSION }}"
ACTION="{{ ACTION }}"
PROJECT="{{PROJECT}}"
MODELS_DIRECTORY="{{ datamodel_directory.path }}/src/{{CHANNEL}}/sql/"
CHANNEL="{{CHANNEL}}"
PROPERTIES="{{ DSE_DATA_MODEL_DEPLOYER_REMOTE_PATH }}/dse-datamodel-deploy-{{ MODEL_TYPE }}/properties-{{ENVIRONMENT}}.json"
HOSTS="{{DB_HOST}}"
PORT="{{PORT}}"
DATABASE="{{DATABASE}}"
USR="{{ DB_USERNAME }}"
PWD="{{ DB_PASSWORD }}"
HOSTS_SUBSCRIPTION="{{HOSTS_SUBSCRIPTION}}"
PORT_SUBSCRIPTION="{{PORT_SUBSCRIPTION}}"
DATABASE_SUBSCRIPTION="{{DATABASE_SUBSCRIPTION}}"
USR_SUBCRIPTION="{{ DB_USERNAME_SUBSCRIPTION }}"
PWD_SUBCRIPTION="{{ DB_PASSWORD_SUBSCRIPTION }}"
node $REMOTE_PATH --env $ENVIRONMENT --v $SCRIPT_VERSION --modelsDirectory $MODELS_DIRECTORY \
	--port $PORT --db $DATABASE --u $USR --p $PWD --h $HOSTS \
	--project $PROJECT --properties $PROPERTIES --channel $CHANNEL --action $ACTION \
	--userSubscription $USR_SUBCRIPTION --passwordSubscription $PWD_SUBCRIPTION \
	--hostSubscription $HOSTS_SUBSCRIPTION --databaseSubscription $DATABASE_SUBSCRIPTION \
	--portSubscription $PORT_SUBSCRIPTION
